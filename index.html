<!DOCTYPE html>
<html>

    <head>

        <title>Movement System</title>
        <meta charset="utf-8">

        <style>

            #canvas{
                width: 1280px;
                height: 720px;
                position: absolute;
                top: 10px;
                left: 10px;
            }

        </style>

        <script type="text/javascript">
        
            window.onload = main;
            var mapMatrix = [];
            var playerPosition = [0, 0];
            var c, ctx;

            function renderMap(){

                if(playerPosition[0] < 5){
                    var renderMinX = 0;
                }else if(playerPosition[0] > mapMatrix[0].length - 5){
                    var renderMinX = mapMatrix[0].length - 9;
                }else{
                    var renderMinX = playerPosition[0] - 4;
                }

                if(playerPosition[1] < 5){
                    var renderMinY = 0;
                }else if(playerPosition[1] > mapMatrix.length - 5){
                    var renderMinY = mapMatrix[1].length - 9;
                }else{
                    var renderMinY = playerPosition[1] - 4;
                }

                var renderMatrix = [];

                for(var i = 0;i < 9;i++){
                    renderMatrix.push([]);
                    for(var j = 0;j < 9;j++){
                        renderMatrix[i].push(mapMatrix[renderMinY + i][renderMinX + j]);
                    }
                }

                ctx.fillStyle = "white";
                ctx.fillRect(0, 0, c.width, c.height);
                
                for(var i = 0;i < renderMatrix.length;i++){
                    for(var j = 0;j < renderMatrix[0].length;j++){
                        if(((i + renderMinY) == playerPosition[1]) && ((j + renderMinX) == playerPosition[0])){
                            ctx.fillStyle = "green";
                        }else if(renderMatrix[i][j]){
                            ctx.fillStyle = "blue";
                        }else{
                            ctx.fillStyle = "red";
                        }
                        ctx.fillRect(j * 45, i * 45, 40, 40);
                    }
                }

            }

            function main(){

                c = getEl("canvas");
                c.height = 720;
                c.width = 1280;
                ctx = c.getContext("2d");

                for(var i = 0;i < 50;i++){
                    mapMatrix.push([]);
                    for(var j = 0;j < 50;j++){
                        mapMatrix[i].push([]);
                        for(var k = 0;k < 50;k++){
                            if(i == 2 || j == 2 || j == 47 || i == 47){
                                mapMatrix[i][j] = 1;
                            }else{
                                mapMatrix[i][j] = 0;
                            }
                        }
                    }
                }

                renderMap();

                window.addEventListener("keydown", function(e){

                    if(e.keyCode == 87 || e.keyCode == 38){
                        if(playerPosition[1] != 0) playerPosition[1] = playerPosition[1] - 1;
                    }else if(e.keyCode == 65 || e.keyCode == 37){
                        if(playerPosition[0] != 0) playerPosition[0] = playerPosition[0] - 1;
                    }else if(e.keyCode == 83 || e.keyCode == 40){
                        if(playerPosition[1] != 49) playerPosition[1] = playerPosition[1] + 1;
                    }else if(e.keyCode == 68 || e.keyCode == 39){
                        if(playerPosition[0] != 49) playerPosition[0] = playerPosition[0] + 1;
                    }

                    renderMap();

                });

            }

            function getEl(id){return document.getElementById(String(id));}

        </script>

    </head>

    <body>

        <canvas id="canvas"></canvas>

    </body>

</html>